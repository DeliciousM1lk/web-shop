{% extends 'base.html' %}

{% block title %} Product List {% endblock %}

{% block content %}
<h1>Product List</h1>

<div>
    {% for p in products %}
    <div>
        {% with img=p.main_image %}
        {% if img %}
        <img src="{{ img.image.url }}" alt="{{ img.alt|default:'No description' }}">
        {% else %}
        <p>No image available</p>
        {% endif %}
        <h2>{{ p.name }}</h2>
        <p>Price:{{ p.price }}</p>
        <p>{{ p.description }}</p>
        <a href="{% url 'catalog:product_detail' slug=p.slug %}">Подробнее</a>
        {% endwith %}
    </div>
    {% empty %}
    <p>Товаров нет</p>
    {% endfor %}
</div>
{% if is_paginated %}
<div class="pagination">
    <span>
      Page {{ page_obj.number }} of {{ paginator.num_pages }}
    </span>
    {% if page_obj.has_previous %}
    <a href="?page={{ page_obj.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">Предыдущая</a>
    {% endif %}

    {% if page_obj.has_next %}
    <a href="?page={{ page_obj.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}{% endif %}">Следующая</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}